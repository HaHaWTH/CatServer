--- a/net/minecraft/tileentity/CommandBlockTileEntity.java
+++ b/net/minecraft/tileentity/CommandBlockTileEntity.java
@@ -15,6 +_,8 @@
 import net.minecraft.world.server.ServerWorld;
 import net.minecraftforge.api.distmarker.Dist;
 import net.minecraftforge.api.distmarker.OnlyIn;
+import org.bukkit.command.CommandSender;
+import org.bukkit.craftbukkit.v1_16_R3.command.CraftBlockCommandSender;
 
 public class CommandBlockTileEntity extends TileEntity {
    private boolean powered;
@@ -22,7 +_,14 @@
    private boolean conditionMet;
    private boolean sendToClient;
    private final CommandBlockLogic commandBlock = new CommandBlockLogic() {
-      public void setCommand(String p_145752_1_) {
+      // CraftBukkit start
+       @Override
+      public CommandSender getBukkitSender(CommandSource wrapper) {
+         return new CraftBlockCommandSender(wrapper, CommandBlockTileEntity.this);
+       }
+      // CraftBukkit end
+
+       public void setCommand(String p_145752_1_) {
          super.setCommand(p_145752_1_);
          CommandBlockTileEntity.this.setChanged();
       }
